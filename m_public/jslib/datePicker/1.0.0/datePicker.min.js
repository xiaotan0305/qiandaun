define("datePicker/1.0.0/datePicker",["jquery","iscroll/2.0.0/iscroll-lite"],function(c,b,d){var e=c("jquery"),g=c("iscroll/2.0.0/iscroll-lite"),f=seajs.data.vars;f.date=f.date||new Date().getTime();function a(){this.setting={START_TIME:0,END_TIME:1};this.con="";this.ulArr=[];this.ulArrL=0;this.bg="";this.dateTxt="";this.confirmBtn="";this.year="2015";this.delimiter="-";this.iscrollArr=[];this.singleLiHeight=30;this.confirmFunc=""}a.prototype={init:function(h){var l=this;l.nowTime=new Date(parseInt(f.date));l.con=e(".dateBox");l.bg=e(".layer");l.dateTxt=e(".dateTxt span");l.confirmBtn=e("#sure");var k=l.type===l.setting.START_TIME?"开始":"结束";l.confirmBtn.siblings().html(k);l.bg.on("click",function(){l.con.hide();l.bg.hide()});l.confirmBtn.on("click",function(){var n=l.ulArr.eq(0).attr("data-val"),o=l.ulArr.eq(1).attr("data-val"),i;if(l.type===l.setting.START_TIME){i=l.dateTxt.eq(l.setting.END_TIME).attr("data-date").split(l.delimiter);if(parseInt(n)>parseInt(l.nowTime.getMonth())+1||(parseInt(n)===parseInt(l.nowTime.getMonth())+1&&parseInt(o)>parseInt(l.nowTime.getDate()))){alert("不能选择大于今天的日期！");return}if(parseInt(n)>parseInt(i[0])||(n===i[0]&&parseInt(o)>parseInt(i[1]))){alert("开始日期不能大于结束日期！");return}if(f.chartType==="line"&&n===i[0]&&Math.abs(parseInt(i[1])-parseInt(o))<6){alert("时间间隔不能小于7天！");return}}if(l.type===l.setting.END_TIME){i=l.dateTxt.eq(l.setting.START_TIME).attr("data-date").split(l.delimiter);if(parseInt(n)>parseInt(l.nowTime.getMonth())+1||(parseInt(n)===parseInt(l.nowTime.getMonth())+1&&parseInt(o)>parseInt(l.nowTime.getDate()))){alert("不能选择大于今天的日期！");return}if(parseInt(n)<parseInt(i[0])||(n===i[0]&&parseInt(o)<parseInt(i[1]))){alert("结束日期不能小于开始日期！");return}if(f.chartType==="line"&&n===i[0]&&Math.abs(parseInt(o)-parseInt(i[1]))<6){alert("时间间隔不能小于七天！");return}}if(n.length===1){n="0"+n}if(o.length===1){o="0"+o}l.dateTxt.eq(l.type).attr("data-date",n+l.delimiter+o);l.dateTxt.eq(l.type).html(n+"月"+o+"日");l.con.hide();l.bg.hide();if(l.confirmFunc){l.confirmFunc()}});l.con.show();l.bg.show();l.ulArr=l.con.find(".blue_dateCon");l.ulArrL=l.ulArr.length;for(var j=0;j<l.ulArrL;j++){var m=new g(l.ulArr[j],{bindToWrapper:true,scrollX:false,scrollY:true,specialEnd:true});m.on("scrollEnd",function(){l.setPosition(this)});l.iscrollArr.push(m)}l.setPositionByDate(h)},setConfirmFun:function(h){if(typeof h==="function"){this.confirmFunc=h}},setPosition:function(m){var l=this,k=e(m.wrapper);var h=Math.round(m.y/l.singleLiHeight);m.scrollTo(0,h*l.singleLiHeight,200);k.find("li").removeClass();var i=k.find("li").eq(Math.abs(h)+3),j=k.closest(".blue_dateCon");i.addClass("on");var n=i.html();if(n.length===1){n="0"+n}j.attr("data-val",n);if(j.index()===0){l.setPositionByDate(n+l.delimiter+"01")}},show:function(h,j){var k=this;if(k.type!==j){k.type=j}if(k.con){var i=k.type===k.setting.START_TIME?"开始":"结束";k.confirmBtn.siblings().html(i);k.con.show();k.bg.show();k.setPositionByDate(h)}else{k.init(h)}},setPositionByDate:function(h){var m=this,l=h.split(m.delimiter);var n=new Date(m.year,l[0],0).getDate();m.ulArr.eq(1).find("ul").children().filter(function(){var o=e(this);var i=o.html();if(i&&i>n){o.hide()}else{o.show()}});for(var k=0;k<m.ulArrL;k++){var j=m.ulArr.eq(k);j.find("li").removeClass();j.find("li").eq(parseInt(l[k])+2).addClass("on");j.attr("data-val",l[k]);m.iscrollArr[k].scrollTo(0,-(parseInt(l[k])-1)*m.singleLiHeight);m.iscrollArr[k].refresh()}}};d.exports=a});